{"version":3,"file":"manager.js","mappings":"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","sources":["webpack://wp-shlink/./src/css/manager.scss","webpack://wp-shlink/webpack/bootstrap","webpack://wp-shlink/webpack/runtime/make namespace object","webpack://wp-shlink/./src/js/manager.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import '../css/manager.scss';\n\nclass ShlinkManager {\n\n\tconstructor() {\n\t\tthis.load().then(this.showResults.bind(this));\n\t}\n\n\tload() {\n\t\treturn fetch('/wp-admin/admin-ajax.php?action=get_shlinks');\n\t}\n\n\tasync showResults(result) {\n\t\tlet response = await result.json();\n\t\tlet html = 'Oops, something unexpected happened';\n\n\t\tif (! response.ok) {\n\t\t\thtml = 'Error: ' + (response.error || 'mystery error');\n\t\t} else {\n\t\t\thtml = this.getListHTML(response.shlink.shortUrls.data);\n\t\t}\n\n\t\tlet el = document.querySelector('.shlink-manager');\n\t\tel.innerHTML = html;\n\t\tel.addEventListener('click', this.clickHandler.bind(this));\n\n\t\tlet form = document.querySelector('.shlink-create');\n\t\tform.addEventListener('submit', this.createShlink.bind(this));\n\t}\n\n\tgetListHTML(data) {\n\t\tlet html = '<ul class=\"shlink-list\">';\n\t\tfor (let shlink of data) {\n\t\t\thtml += this.getItemHTML(shlink);\n\t\t}\n\t\thtml += '</ul>';\n\t\treturn html;\n\t}\n\n\tgetItemHTML(shlink) {\n\t\tlet dataAttrs = this.getItemDataAttrs(shlink);\n\t\tlet contentHTML = this.getItemContentHTML(shlink);\n\t\treturn `<li class=\"shlink-item\"${dataAttrs}>\n\t\t\t${contentHTML}\n\t\t</li>`;\n\t}\n\n\tgetItemDataAttrs(shlink) {\n\t\tlet dataAttrs = '';\n\t\tdataAttrs += ` data-title=\"${this.escape(shlink.title)}\"`;\n\t\tdataAttrs += ` data-long-url=\"${this.escape(shlink.longUrl)}\"`;\n\t\tdataAttrs += ` data-short-url=\"${this.escape(shlink.shortUrl)}\"`;\n\t\tdataAttrs += ` data-short-code=\"${this.escape(shlink.shortCode)}\"`;\n\t\treturn dataAttrs;\n\t}\n\n\tgetItemContentHTML(shlink) {\n\t\tlet title = shlink.title || shlink.longUrl;\n\t\treturn `<div class=\"shlink-item__content\">\n\t\t\t<div class=\"shlink-item__clicks\">\n\t\t\t\t${shlink.visitsCount} clicks\n\t\t\t</div>\n\t\t\t<div class=\"shlink-item__links\">\n\t\t\t\t<div class=\"shlink-item__long-url\">${title}</div>\n\t\t\t\t<div class=\"shlink-item__short-url\">${shlink.shortUrl}</div>\n\t\t\t\t<div class=\"shlink-loading\">\n\t\t\t\t\t<span class=\"shlink-loading-dot shlink-loading-dot--1\"></span>\n\t\t\t\t\t<span class=\"shlink-loading-dot shlink-loading-dot--2\"></span>\n\t\t\t\t\t<span class=\"shlink-loading-dot shlink-loading-dot--3\"></span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>`;\n\t}\n\n\tasync createShlink(event) {\n\t\tevent.preventDefault();\n\n\t\tlet form = event.target;\n\t\tlet url = form.getAttribute('action');\n\n\t\tlet longURLField = form.querySelector('.shlink-long-url');\n\t\tlet shortCodeField = form.querySelector('.shlink-short-code');\n\t\tlet titleField = form.querySelector('.shlink-title');\n\n\t\tlet list = document.querySelector('.shlink-list');\n\t\tlist.innerHTML = this.getItemHTML({\n\t\t\tlongUrl: longURLField.value,\n\t\t\tshortCode: shortCodeField.value,\n\t\t\ttitle: titleField.value,\n\t\t\tshortUrl: '',\n\t\t\tvisitsCount: 0\n\t\t}) + list.innerHTML;\n\n\t\tlet item = list.querySelectorAll('.shlink-item')[0];\n\t\titem.classList.add('shlink-item--is-saving');\n\n\t\tlet result = await fetch(url, {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\n\t\t\t},\n\t\t\tbody: this.encodeFormData({\n\t\t\t\taction: 'create_shlink',\n\t\t\t\tlong_url: longURLField.value,\n\t\t\t\tshort_code: shortCodeField.value,\n\t\t\t\ttitle: titleField.value\n\t\t\t})\n\t\t});\n\n\t\tlongURLField.value = '';\n\t\tshortCodeField.value = '';\n\t\ttitleField.value = '';\n\n\t\tlet response = await result.json();\n\t\titem.innerHTML = this.getItemContentHTML(response.shlink);\n\t\titem.classList.remove('shlink-item--is-saving');\n\n\t\titem.setAttribute('data-title', response.shlink.title || '');\n\t\titem.setAttribute('data-short-code', response.shlink.shortCode);\n\t\titem.setAttribute('data-short-url', response.shlink.shortUrl);\n\t}\n\n\tclickHandler(event) {\n\t\tvar item;\n\t\tif (event.target.classList.contains('button')) {\n\t\t\treturn;\n\t\t}\n\t\tif (event.target.classList.contains('shlink-item')) {\n\t\t\titem = event.target;\n\t\t} else if (event.target.closest('.shlink-item')) {\n\t\t\titem = event.target.closest('.shlink-item');\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t\tthis.editShlink(item);\n\t}\n\n\teditShlink(item) {\n\t\tlet current = document.querySelector('.shlink-item--is-editing');\n\t\tif (current) {\n\t\t\tcurrent.classList.remove('shlink-item--is-editing');\n\t\t}\n\t\titem.classList.add('shlink-item--is-editing');\n\n\t\tvar form;\n\t\tif (item.querySelector('.shlink-item__edit')) {\n\t\t\tform = item.querySelector('.shlink-item__edit');\n\t\t} else {\n\t\t\tlet shortUrl = item.getAttribute('data-short-url');\n\t\t\tform = item.appendChild(document.createElement('form'));\n\t\t\tform.setAttribute('action', '/wp-admin/admin-ajax.php');\n\t\t\tform.setAttribute('method', 'POST');\n\t\t\tform.classList.add('shlink-item__edit');\n\t\t\tform.innerHTML = `\n\t\t\t\t\t<h3 class=\"shlink-edit-title\">${shortUrl}</h3>\n\t\t\t\t\t<div class=\"shlink-edit-field\">\n\t\t\t\t\t\t<label for=\"shlink-edit-title\" class=\"shlink-label\">Title</label>\n\t\t\t\t\t\t<input type=\"text\" id=\"shlink-edit-title\" name=\"title\" class=\"shlink-edit-title regular-text ltr\" value=\"${item.getAttribute('data-title')}\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"shlink-edit-field\">\n\t\t\t\t\t\t<label for=\"shlink-edit-long-url\" class=\"shlink-label\">Long URL</label>\n\t\t\t\t\t\t<input type=\"text\" id=\"shlink-edit-long-url\" name=\"long_url\" class=\"shlink-edit-long-url regular-text ltr\" value=\"${item.getAttribute('data-long-url')}\">\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"shlink-edit-buttons\">\n\t\t\t\t\t\t<input type=\"submit\" value=\"Save\" class=\"shlink-save button button-primary\">\n\t\t\t\t\t\t<input type=\"button\" value=\"Cancel\" class=\"shlink-cancel button\">\n\t\t\t\t\t</div>\n\t\t\t`;\n\t\t\tform.addEventListener('submit', this.saveShlink.bind(this));\n\n\t\t\tlet cancel = form.querySelector('.shlink-cancel');\n\t\t\tcancel.addEventListener('click', event => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tlet item = event.target.closest('.shlink-item');\n\t\t\t\titem.classList.remove('shlink-item--is-editing');\n\t\t\t});\n\t\t}\n\t}\n\n\tasync saveShlink(event) {\n\t\tevent.preventDefault();\n\n\t\tlet item = event.target.closest('.shlink-item');\n\t\tlet title = item.querySelector('.shlink-edit-title').value;\n\t\tlet longUrl = item.querySelector('.shlink-edit-long-url').value;\n\t\tlet shortCode = item.querySelector('.shlink-edit-short-code').value;\n\n\t\titem.classList.remove('shlink-item--is-editing');\n\t\titem.classList.add('shlink-item--is-saving');\n\n\t\tlet result = await fetch('/wp-admin/admin-ajax.php', {\n\t\t\tmethod: 'POST',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded'\n\t\t\t},\n\t\t\tbody: this.encodeFormData({\n\t\t\t\taction: 'update_shlink',\n\t\t\t\ttitle: title,\n\t\t\t\tlong_url: longUrl,\n\t\t\t\told_short_code: item.getAttribute('data-short-code'),\n\t\t\t\tnew_short_code: shortCode\n\t\t\t})\n\t\t});\n\t\tlet response = await result.json();\n\t\tif (response && response.ok && response.shlink) {\n\t\t\tlet shlink = response.shlink;\n\n\t\t\tif (shlink.shortCode) {\n\t\t\t\titem.innerHTML = this.getItemContentHTML(response.shlink);\n\t\t\t\titem.classList.remove('shlink-item--is-saving');\n\n\t\t\t\titem.setAttribute('data-title', title);\n\t\t\t\titem.setAttribute('data-long-url', longUrl);\n\t\t\t\titem.setAttribute('data-short-code', shortCode);\n\n\t\t\t\tlet longURL = item.querySelector('.shlink-item__long-url');\n\t\t\t\tlongURL.innerHTML = title || longUrl;\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\titem.classList.add('shlink-item--is-editing');\n\t\t\t\titem.classList.remove('shlink-item--is-saving');\n\n\t\t\t\tif (shlink.title && shlink.detail) {\n\t\t\t\t\talert(`Error: ${shlink.title}. ${shlink.detail}.`);\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\talert('Sorry, there was a problem saving changes to the Shlink.');\n\t\treturn false;\n\t}\n\n\tencodeFormData(data) {\n\t\tlet assignments = Object.keys(data).map(key => {\n\t\t\tkey = encodeURIComponent(key);\n\t\t\tlet value = encodeURIComponent(data[key]);\n\t\t\treturn `${key}=${value}`;\n\t\t});\n\t\treturn assignments.join('&');\n\t}\n\n\tescape(value) {\n\t\tif (! value) {\n\t\t\treturn '';\n\t\t}\n\t\treturn ('' + value)\n\t\t\t.replace(/&/g, '&amp;')\n\t\t\t.replace(/'/g, '&apos;')\n\t\t\t.replace(/\"/g, '&quot;')\n\t\t\t.replace(/</g, '&lt;')\n\t\t\t.replace(/>/g, '&gt;');\n\t}\n\n}\n\nnew ShlinkManager();\n"],"names":["ShlinkManager","constructor","load","then","showResults","bind","fetch","result","response","json","html","ok","error","getListHTML","shlink","shortUrls","data","el","document","querySelector","innerHTML","addEventListener","clickHandler","form","createShlink","getItemHTML","dataAttrs","getItemDataAttrs","contentHTML","getItemContentHTML","escape","title","longUrl","shortUrl","shortCode","visitsCount","event","preventDefault","target","url","getAttribute","longURLField","shortCodeField","titleField","list","value","item","querySelectorAll","classList","add","method","headers","body","encodeFormData","action","long_url","short_code","remove","setAttribute","contains","closest","editShlink","current","appendChild","createElement","saveShlink","cancel","old_short_code","new_short_code","longURL","detail","alert","assignments","Object","keys","map","key","encodeURIComponent","join","replace"],"sourceRoot":""}